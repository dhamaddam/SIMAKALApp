"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4874],{5961:(y,h,n)=>{n.d(h,{GW:()=>o,dk:()=>l,oK:()=>s});var s=(()=>((s=s||{}).Prompt="PROMPT",s.Camera="CAMERA",s.Photos="PHOTOS",s))(),o=(()=>((o=o||{}).Rear="REAR",o.Front="FRONT",o))(),l=(()=>((l=l||{}).Uri="uri",l.Base64="base64",l.DataUrl="dataUrl",l))()},4874:(y,h,n)=>{n.r(h),n.d(h,{UpdateKalibrasiPageModule:()=>D});var s=n(6814),o=n(7852),l=n(4670),g=n(5861),c=n(95),K=n(6676),T=n(7394),P=n(2726),U=n(5961);const S=(0,P.fo)("Camera",{web:()=>n.e(6468).then(n.bind(n,6468)).then(e=>new e.CameraWeb)});var x=n(6629),t=n(6689),C=n(3454),F=n(2690),_=n(5175),M=n(5557),Z=n(8752);function B(e,u){1&e&&(t.TgZ(0,"div",19),t._UZ(1,"ion-spinner",20),t.qZA())}function N(e,u){if(1&e&&t.GkF(0,21),2&e){t.oxw();const a=t.MAs(59);t.Q6J("ngTemplateOutlet",a)}}function J(e,u){if(1&e&&t.GkF(0,21),2&e){t.oxw();const a=t.MAs(61);t.Q6J("ngTemplateOutlet",a)}}function Y(e,u){}function w(e,u){if(1&e){const a=t.EpF();t.TgZ(0,"ion-button",22),t.NdJ("click",function(){t.CHM(a);const r=t.oxw();return t.KtG(r.sendNotificationBPFK())}),t._uU(1,"Kirim Notifikasi BPFK"),t.qZA()}}const E=[{path:"",component:(()=>{class e{constructor(a,i,r,d,b,A,p){this.router=a,this.global=i,this.inputAlatKesehatanServices=r,this.authServices=d,this.fb=b,this.navExtras=A,this.actionSheetController=p,this.formTitle="Update Kalibrasi",this.isLoading=!1,this.allDataAlatKesehatanById=[],this.allDataAlatKesehatanByIdSub=new T.w0,this.today=K().format("YYYY-MM-DD"),this.resultData=[],this.calibration_status="",this.id_alat="",this.imgUrl="",this.image_ext="",this.messageMonth="",this.uploader=(0,x.Uploader)({apiKey:"public_FW25bYRFasDp9zGButccP2qyeEcZ"}),this.options={multi:!0},this.onComplete=f=>{var m;this.uploadedFileUrl=null===(m=f[0])||void 0===m?void 0:m.fileUrl},this.uploadedFileUrl=void 0}ngOnInit(){this.getAuth(),this.allDataAlatKesehatanById=this.navExtras.getExtras(),this.resultData.push(this.navExtras.getExtras()),this.resultData.forEach(a=>{console.log("element",a.details[0].calibration_status),this.myForm=this.fb.group({tanggal:[this.today,[c.kI.required]],monitoring_status:[""],name:[a.name],pic:[a.pic],inventory_no:[a.inventory_no],room:[a.room],type:[a.type],calibration_status:[""],owner_id:[a.owner_id],initial_calibration:[a.details[0].initial_calibration],re_calibration:[a.details[0].re_calibration],initial_monitoring:[a.details[0].initial_monitoring],re_monitoring:[a.details[0].re_monitoring]}),this.messageMonth=a.details[0].month_diff,this.messageMonth=!(this.messageMonth>6),this.id_alat=a.id,this.imgUrl=a.image,null==a.calibration_status?(this.myForm.form="gagal_kalibrasi",this.calibration_status="status_belum_diisi"):(this.myForm.form=a.calibration_status,this.calibration_status=a.calibration_status),console.log("this imgUrl",this.imgUrl)})}getAuth(){var a=this;return(0,g.Z)(function*(){const i=yield a.authServices.getId();if(i){let r=JSON.parse(i);console.log("this.token",r.access_token),a.token=r.access_token}})()}sendNotificationBPFK(){var a=this;let i=this.myForm.value;try{setTimeout((0,g.Z)(function*(){console.log("getAuth(){",a.token),yield a.inputAlatKesehatanServices.sendAndCreateNotificationBPFK(i,a.token)}),1e3)}catch(r){throw r}}uploadImage(){var a=this;return(0,g.Z)(function*(){yield(yield a.actionSheetController.create({header:"Choose from",buttons:[{text:"Gallery",icon:"images",handler:()=>{console.log("gallery clicked"),a.upload(U.oK.Photos)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]})).present()})()}upload(a){var i=this;return(0,g.Z)(function*(){try{const r=yield S.getPhoto({source:a,quality:50,resultType:U.dk.Base64});if(console.log("image output",r),r&&r.base64String){const d=i.b64toBlob(r.base64String,`image/${r.format}`);i.image_ext=r.format,i.blobData=d}}catch(r){console.log(r),i.global.apiErrorHandler(r)}})()}b64toBlob(a,i="",r=512){const d=atob(a),b=[];for(let p=0;p<d.length;p+=r){const f=d.slice(p,p+r),m=new Array(f.length);for(let v=0;v<f.length;v++)m[v]=f.charCodeAt(v);const Q=new Uint8Array(m);b.push(Q)}return new Blob(b,{type:i})}placeData(a){var i=this;try{setTimeout((0,g.Z)(function*(){yield i.inputAlatKesehatanServices.updateAlatKesehatanCalibration(i.id_alat,a,i.token),i.isLoading=!1,i.global.hideLoader(),i.router.navigate(["/menu/jadwal-kalibrasi"],{})}),1e3)}catch(r){throw r}}saveData(){this.isLoading=!0,this.global.showLoader(),console.log(this.myForm.value),this.myForm.value.file=this.uploadedFileUrl,this.placeData(this.myForm.value),this.isLoading=!1,this.global.hideLoader()}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(l.F0),t.Y36(C.U),t.Y36(F.f),t.Y36(_.e),t.Y36(c.qu),t.Y36(M.l),t.Y36(o.BX))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-update-kalibrasi"]],decls:62,vars:15,consts:[[1,"ion-no-border"],["slot","start"],[3,"fullscreen"],[1,"ion-margin",3,"formGroup","ngSubmit"],["class","ion-text-center alignSpinner",4,"ngIf"],[1,"ctm-font-2"],["formControlName","name","type","text",3,"readonly"],["onError","this.src='assets/download.jpeg'","alt","",1,"center",3,"src"],["interface","action-sheet","formControlName","calibration_status","placeholder","Status Kalibrasi",3,"ngModel","ngModelChange"],["value","berhasil_kalibrasi"],["value","gagal_kalibrasi"],["target","_blank",3,"href"],["uploadButton","",3,"uploadComplete","uploadOptions","uploader"],["type","submit","expand","full","color","success","shape","round","expand","block"],["expand","full","color","medium","shape","round"],[3,"ngSwitch"],[3,"ngTemplateOutlet",4,"ngSwitchCase"],["hidden",""],["show",""],[1,"ion-text-center","alignSpinner"],["color","primary"],[3,"ngTemplateOutlet"],["expand","full","color","danger","shape","round","expand","block",3,"click"]],template:function(a,i){1&a&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",1),t._UZ(5,"ion-back-button"),t.qZA()()(),t.TgZ(6,"ion-content",2)(7,"form",3),t.NdJ("ngSubmit",function(){return i.saveData()}),t.YNc(8,B,2,0,"div",4),t.TgZ(9,"ion-grid")(10,"ion-row")(11,"ion-col")(12,"ion-label",5),t._uU(13,"Nama Alat"),t.qZA(),t.TgZ(14,"ion-item"),t._UZ(15,"ion-input",6),t.qZA()()()(),t.TgZ(16,"ion-grid")(17,"ion-row")(18,"ion-col")(19,"ion-label",5),t._uU(20,"Foto Alat"),t.qZA(),t._UZ(21,"img",7),t.qZA()()(),t.TgZ(22,"ion-grid")(23,"ion-row")(24,"ion-col")(25,"ion-label",5),t._uU(26,"Kondisi Alat"),t.qZA(),t.TgZ(27,"ion-list")(28,"ion-item")(29,"ion-select",8),t.NdJ("ngModelChange",function(d){return i.myForm.form=d}),t.TgZ(30,"ion-select-option",9),t._uU(31,"Berhasil Kalibrasi"),t.qZA(),t.TgZ(32,"ion-select-option",10),t._uU(33,"Gagal Kalibrasi"),t.qZA()()()()()()(),t.TgZ(34,"ion-grid")(35,"ion-row")(36,"ion-col")(37,"ion-label",5),t._uU(38,"File"),t.qZA(),t.TgZ(39,"ion-item")(40,"a",11),t._uU(41),t.qZA(),t.TgZ(42,"button",12),t._uU(43," Upload a file... "),t.qZA()()()()(),t.TgZ(44,"ion-grid")(45,"ion-row")(46,"ion-col")(47,"ion-button",13),t._uU(48,"Simpan"),t.qZA()(),t.TgZ(49,"ion-col")(50,"ion-button",14),t._uU(51,"Kembali"),t.qZA()()()(),t.TgZ(52,"ion-grid")(53,"ion-row")(54,"ion-col"),t.ynx(55,15),t.YNc(56,N,1,1,"ng-container",16),t.YNc(57,J,1,1,"ng-container",16),t.BQk(),t.YNc(58,Y,0,0,"ng-template",null,17,t.W1O),t.YNc(60,w,2,0,"ng-template",null,18,t.W1O),t.qZA()()()()()),2&a&&(t.xp6(3),t.hij(" ",i.formTitle," "),t.xp6(3),t.Q6J("fullscreen",!0),t.xp6(1),t.Q6J("formGroup",i.myForm),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(7),t.Q6J("readonly",!0),t.xp6(6),t.Q6J("src",i.global.getSantizeUrl(i.imgUrl),t.LSH),t.xp6(8),t.Q6J("ngModel",i.myForm.form),t.xp6(11),t.s9C("href",i.uploadedFileUrl,t.LSH),t.xp6(1),t.Oqu(i.uploadedFileUrl),t.xp6(1),t.Q6J("uploadComplete",i.onComplete)("uploadOptions",i.options)("uploader",i.uploader),t.xp6(13),t.Q6J("ngSwitch",i.messageMonth),t.xp6(1),t.Q6J("ngSwitchCase",!1),t.xp6(1),t.Q6J("ngSwitchCase",!0))},dependencies:[s.O5,s.tP,s.RF,s.n9,c._Y,c.JJ,c.JL,Z.c5,c.sg,c.u,o.oU,o.YG,o.Sm,o.wI,o.W2,o.jY,o.Gu,o.pK,o.Ie,o.Q$,o.q_,o.Nd,o.t9,o.n0,o.PQ,o.wd,o.sr,o.QI,o.j9,o.cs],styles:["ion-avatar[_ngcontent-%COMP%]{width:150px;height:150px;margin-top:20px}ion-grid[_ngcontent-%COMP%]{margin-top:10px}"]}),e})()}];let O=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.Bz.forChild(E),l.Bz]}),e})(),D=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[s.ez,c.u5,Z.Mw,c.UX,o.Pc,O]}),e})()},5557:(y,h,n)=>{n.d(h,{l:()=>o});var s=n(6689);let o=(()=>{class l{constructor(){}setExtras(c){this.extras=c}getExtras(){return this.extras}}return l.\u0275fac=function(c){return new(c||l)},l.\u0275prov=s.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()}}]);