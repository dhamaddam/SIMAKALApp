"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4874],{5961:(v,p,l)=>{l.d(p,{GW:()=>o,dk:()=>r,oK:()=>c});var c=(()=>((c=c||{}).Prompt="PROMPT",c.Camera="CAMERA",c.Photos="PHOTOS",c))(),o=(()=>((o=o||{}).Rear="REAR",o.Front="FRONT",o))(),r=(()=>((r=r||{}).Uri="uri",r.Base64="base64",r.DataUrl="dataUrl",r))()},4874:(v,p,l)=>{l.r(p),l.d(p,{UpdateKalibrasiPageModule:()=>W});var c=l(6814),o=l(7852),r=l(4670),g=l(5861),u=l(95),T=l(6676),K=l(7394),x=l(2726),U=l(5961);const S=(0,x.fo)("Camera",{web:()=>l.e(6468).then(l.bind(l,6468)).then(e=>new e.CameraWeb)});var P=l(6629),t=l(6689),Z=l(3454),C=l(2690),F=l(5175),N=l(5557),y=l(8752);function M(e,s){1&e&&(t.TgZ(0,"div",22),t._UZ(1,"ion-spinner",23),t.qZA())}function w(e,s){if(1&e&&t.GkF(0,24),2&e){t.oxw();const a=t.MAs(70);t.Q6J("ngTemplateOutlet",a)}}function J(e,s){if(1&e&&t.GkF(0,24),2&e){t.oxw();const a=t.MAs(72);t.Q6J("ngTemplateOutlet",a)}}function k(e,s){if(1&e&&t.GkF(0,24),2&e){t.oxw();const a=t.MAs(64);t.Q6J("ngTemplateOutlet",a)}}function Y(e,s){if(1&e&&t.GkF(0,24),2&e){t.oxw();const a=t.MAs(64);t.Q6J("ngTemplateOutlet",a)}}function O(e,s){if(1&e&&t.GkF(0,24),2&e){t.oxw();const a=t.MAs(66);t.Q6J("ngTemplateOutlet",a)}}function Q(e,s){if(1&e&&t.GkF(0,24),2&e){t.oxw();const a=t.MAs(68);t.Q6J("ngTemplateOutlet",a)}}function B(e,s){if(1&e){const a=t.EpF();t.TgZ(0,"ion-button",25),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.sendNotificationBPFK())}),t._uU(1,"Kirim Notifikasi BPFK"),t.qZA()}}function I(e,s){if(1&e){const a=t.EpF();t.TgZ(0,"ion-button",25),t.NdJ("click",function(){t.CHM(a);const n=t.oxw();return t.KtG(n.sendNotificationADMIN())}),t._uU(1,"Kirim Notifikasi ADMIN"),t.qZA()}}function D(e,s){}function E(e,s){}function G(e,s){}const L=[{path:"",component:(()=>{class e{constructor(a,i,n,d,b,A,h){this.router=a,this.global=i,this.inputAlatKesehatanServices=n,this.authServices=d,this.fb=b,this.navExtras=A,this.actionSheetController=h,this.formTitle="Update Kalibrasi",this.isLoading=!1,this.allDataAlatKesehatanById=[],this.allDataAlatKesehatanByIdSub=new K.w0,this.today=T().format("YYYY-MM-DD"),this.resultData=[],this.calibration_status="",this.id_alat="",this.imgUrl="",this.image_ext="",this.messageMonth="",this.uploader=(0,P.Uploader)({apiKey:"public_FW25bYRFasDp9zGButccP2qyeEcZ"}),this.options={multi:!0},this.onComplete=f=>{var m;this.uploadedFileUrl=null===(m=f[0])||void 0===m?void 0:m.fileUrl},this.uploadedFileUrl=void 0}ngOnInit(){this.getAuth(),this.allDataAlatKesehatanById=this.navExtras.getExtras(),this.resultData.push(this.navExtras.getExtras()),this.resultData.forEach(a=>{console.log("element",a.details[0].calibration_status),this.myForm=this.fb.group({tanggal:[this.today,[u.kI.required]],monitoring_status:[""],name:[a.name],pic:[a.pic],inventory_no:[a.inventory_no],room:[a.room],type:[a.type],calibration_status:[""],owner_id:[a.owner_id],initial_calibration:[a.details[0].initial_calibration],re_calibration:[a.details[0].re_calibration],initial_monitoring:[a.details[0].initial_monitoring],re_monitoring:[a.details[0].re_monitoring]}),this.messageMonth=a.details[0].month_diff,this.messageMonth=!(this.messageMonth>6),this.id_alat=a.id,this.imgUrl=a.image,null==a.calibration_status?(this.myForm.form="gagal_kalibrasi",this.calibration_status="status_belum_diisi"):(this.myForm.form=a.calibration_status,this.calibration_status=a.calibration_status),console.log("this imgUrl",this.imgUrl)})}formClose(){this.router.navigate(["/menu/jadwal-kalibrasi"],{})}getAuth(){var a=this;return(0,g.Z)(function*(){const i=yield a.authServices.getId();if(i){let n=JSON.parse(i);console.log("this.token",n.access_token),a.roles=n.role,a.token=n.access_token}})()}sendNotificationBPFK(){var a=this;let i=this.myForm.value;try{setTimeout((0,g.Z)(function*(){console.log("getAuth(){",a.token),yield a.inputAlatKesehatanServices.sendAndCreateNotificationBPFK(i,a.token)}),1e3)}catch(n){throw n}}sendNotificationADMIN(){var a=this;let i=this.myForm.value;try{setTimeout((0,g.Z)(function*(){console.log("getAuth(){",a.token),yield a.inputAlatKesehatanServices.sendAndCreateNotificationINSTALASI(i,a.token)}),1e3)}catch(n){throw n}}uploadImage(){var a=this;return(0,g.Z)(function*(){yield(yield a.actionSheetController.create({header:"Choose from",buttons:[{text:"Gallery",icon:"images",handler:()=>{console.log("gallery clicked"),a.upload(U.oK.Photos)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]})).present()})()}upload(a){var i=this;return(0,g.Z)(function*(){try{const n=yield S.getPhoto({source:a,quality:50,resultType:U.dk.Base64});if(console.log("image output",n),n&&n.base64String){const d=i.b64toBlob(n.base64String,`image/${n.format}`);i.image_ext=n.format,i.blobData=d}}catch(n){console.log(n),i.global.apiErrorHandler(n)}})()}b64toBlob(a,i="",n=512){const d=atob(a),b=[];for(let h=0;h<d.length;h+=n){const f=d.slice(h,h+n),m=new Array(f.length);for(let _=0;_<f.length;_++)m[_]=f.charCodeAt(_);const j=new Uint8Array(m);b.push(j)}return new Blob(b,{type:i})}placeData(a){var i=this;try{setTimeout((0,g.Z)(function*(){yield i.inputAlatKesehatanServices.updateAlatKesehatanCalibration(i.id_alat,a,i.token),i.isLoading=!1,i.global.hideLoader(),i.router.navigate(["/menu/jadwal-kalibrasi"],{})}),1e3)}catch(n){throw n}}saveData(){this.isLoading=!0,this.global.showLoader(),console.log(this.myForm.value),this.myForm.value.file=this.uploadedFileUrl,this.placeData(this.myForm.value),this.isLoading=!1,this.global.hideLoader()}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(r.F0),t.Y36(Z.U),t.Y36(C.f),t.Y36(F.e),t.Y36(u.qu),t.Y36(N.l),t.Y36(o.BX))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-update-kalibrasi"]],decls:73,vars:20,consts:[[1,"ion-no-border"],["slot","start"],[3,"fullscreen"],[1,"ion-margin",3,"formGroup","ngSubmit"],["class","ion-text-center alignSpinner",4,"ngIf"],[1,"ctm-font-2"],["formControlName","name","type","text",3,"readonly"],["onError","this.src='assets/download.jpeg'","alt","",1,"center",3,"src"],["interface","action-sheet","formControlName","calibration_status","placeholder","Status Kalibrasi",3,"ngModel","ngModelChange"],["value","berhasil_kalibrasi"],["value","gagal_kalibrasi"],["target","_blank",3,"href"],["uploadButton","",3,"uploadComplete","uploadOptions","uploader"],["type","submit","expand","full","color","success","shape","round","expand","block"],["expand","full","color","medium","shape","round",3,"click"],[3,"ngSwitch"],[3,"ngTemplateOutlet",4,"ngSwitchCase"],["nameDefault",""],["nameINSTALASI",""],["nameBPFK",""],["hidden",""],["show",""],[1,"ion-text-center","alignSpinner"],["color","primary"],[3,"ngTemplateOutlet"],["expand","full","color","danger","shape","round","expand","block",3,"click"]],template:function(a,i){1&a&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),t._uU(3),t.qZA(),t.TgZ(4,"ion-buttons",1),t._UZ(5,"ion-back-button"),t.qZA()()(),t.TgZ(6,"ion-content",2)(7,"form",3),t.NdJ("ngSubmit",function(){return i.saveData()}),t.YNc(8,M,2,0,"div",4),t.TgZ(9,"ion-grid")(10,"ion-row")(11,"ion-col")(12,"ion-label",5),t._uU(13,"Nama Alat"),t.qZA(),t.TgZ(14,"ion-item"),t._UZ(15,"ion-input",6),t.qZA()()()(),t.TgZ(16,"ion-grid")(17,"ion-row")(18,"ion-col")(19,"ion-label",5),t._uU(20,"Foto Alat"),t.qZA(),t._UZ(21,"img",7),t.qZA()()(),t.TgZ(22,"ion-grid")(23,"ion-row")(24,"ion-col")(25,"ion-label",5),t._uU(26,"Kondisi Alat"),t.qZA(),t.TgZ(27,"ion-list")(28,"ion-item")(29,"ion-select",8),t.NdJ("ngModelChange",function(d){return i.myForm.form=d}),t.TgZ(30,"ion-select-option",9),t._uU(31,"Berhasil Kalibrasi"),t.qZA(),t.TgZ(32,"ion-select-option",10),t._uU(33,"Gagal Kalibrasi"),t.qZA()()()()()()(),t.TgZ(34,"ion-grid")(35,"ion-row")(36,"ion-col")(37,"ion-label",5),t._uU(38,"File"),t.qZA(),t.TgZ(39,"ion-item")(40,"a",11),t._uU(41),t.qZA(),t.TgZ(42,"button",12),t._uU(43," Upload a file... "),t.qZA()()()()(),t.TgZ(44,"ion-grid")(45,"ion-row")(46,"ion-col")(47,"ion-button",13),t._uU(48,"Simpan"),t.qZA()(),t.TgZ(49,"ion-col")(50,"ion-button",14),t.NdJ("click",function(){return i.formClose()}),t._uU(51,"Kembali"),t.qZA()()()(),t.TgZ(52,"ion-grid")(53,"ion-row")(54,"ion-col"),t.ynx(55,15),t.YNc(56,w,1,1,"ng-container",16),t.YNc(57,J,1,1,"ng-container",16),t.BQk(),t.ynx(58,15),t.YNc(59,k,1,1,"ng-container",16),t.YNc(60,Y,1,1,"ng-container",16),t.YNc(61,O,1,1,"ng-container",16),t.YNc(62,Q,1,1,"ng-container",16),t.YNc(63,B,2,0,"ng-template",null,17,t.W1O),t.YNc(65,I,2,0,"ng-template",null,18,t.W1O),t.YNc(67,D,0,0,"ng-template",null,19,t.W1O),t.BQk(),t.YNc(69,E,0,0,"ng-template",null,20,t.W1O),t.YNc(71,G,0,0,"ng-template",null,21,t.W1O),t.qZA()()()()()),2&a&&(t.xp6(3),t.hij(" ",i.formTitle," "),t.xp6(3),t.Q6J("fullscreen",!0),t.xp6(1),t.Q6J("formGroup",i.myForm),t.xp6(1),t.Q6J("ngIf",i.isLoading),t.xp6(7),t.Q6J("readonly",!0),t.xp6(6),t.Q6J("src",i.global.getSantizeUrl(i.imgUrl),t.LSH),t.xp6(8),t.Q6J("ngModel",i.myForm.form),t.xp6(11),t.s9C("href",i.uploadedFileUrl,t.LSH),t.xp6(1),t.Oqu(i.uploadedFileUrl),t.xp6(1),t.Q6J("uploadComplete",i.onComplete)("uploadOptions",i.options)("uploader",i.uploader),t.xp6(13),t.Q6J("ngSwitch",i.messageMonth),t.xp6(1),t.Q6J("ngSwitchCase",!1),t.xp6(1),t.Q6J("ngSwitchCase",!0),t.xp6(1),t.Q6J("ngSwitch",i.roles),t.xp6(1),t.Q6J("ngSwitchCase","ADMIN"),t.xp6(1),t.Q6J("ngSwitchCase","KATIM"),t.xp6(1),t.Q6J("ngSwitchCase","INSTALASI"),t.xp6(1),t.Q6J("ngSwitchCase","BPFK"))},dependencies:[c.O5,c.tP,c.RF,c.n9,u._Y,u.JJ,u.JL,y.c5,u.sg,u.u,o.oU,o.YG,o.Sm,o.wI,o.W2,o.jY,o.Gu,o.pK,o.Ie,o.Q$,o.q_,o.Nd,o.t9,o.n0,o.PQ,o.wd,o.sr,o.QI,o.j9,o.cs],styles:["ion-avatar[_ngcontent-%COMP%]{width:150px;height:150px;margin-top:20px}ion-grid[_ngcontent-%COMP%]{margin-top:10px}"]}),e})()}];let R=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[r.Bz.forChild(L),r.Bz]}),e})(),W=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.ez,u.u5,y.Mw,u.UX,o.Pc,R]}),e})()},5557:(v,p,l)=>{l.d(p,{l:()=>o});var c=l(6689);let o=(()=>{class r{constructor(){}setExtras(u){this.extras=u}getExtras(){return this.extras}}return r.\u0275fac=function(u){return new(u||r)},r.\u0275prov=c.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()}}]);